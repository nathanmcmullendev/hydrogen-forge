# HYDROGEN FORGE - Setup Log & MCP Modifications
## Running Documentation of All Setup Steps, MCP Changes, and Developer Experience Notes

---

## SESSION 1: January 9, 2026

### Initial Setup Process

#### Step 1: Create Hydrogen Project
```bash
cd C:\xampp\htdocs\HYDROGEN-FORGE
npm create @shopify/hydrogen@latest -- --template skeleton starter-skeleton
```

**Prompts answered:**
- Where to create: `starter-skeleton`
- Language: `TypeScript`
- Install dependencies: `Yes`

**Result:** Project created at `C:\xampp\htdocs\HYDROGEN-FORGE\starter-skeleton`

**Important Note:** Initial setup uses Mock.shop (demo data), NOT your real store.

---

#### Step 2: Link to Real Shopify Store
```bash
cd C:\xampp\htdocs\HYDROGEN-FORGE\starter-skeleton
npx shopify hydrogen link
```

**What this does:**
1. Opens browser for Shopify Partner OAuth login
2. Lets you select your dev store
3. Auto-configures `.env` with correct tokens

**Files modified:**
- `.env` - Updated with real store credentials
- `.shopify/` folder created (config storage)

---

#### Step 3: Verify Connection
```bash
cd C:\xampp\htdocs\HYDROGEN-FORGE\starter-skeleton
npm run dev
```

**Expected result:** Dev server starts, real products visible (DNK Black Shoes, not snowboards)

---

### MCP OBSERVATIONS & PAIN POINTS

#### Pain Point 1: Interactive Commands in Claude Code
**Problem:** `shopify hydrogen link` requires browser login - Claude Code can't handle this directly.

**Current workaround:** User runs command in separate terminal.

**IMPROVEMENT FOR HYDROGEN-FORGE MCP:**
```
Tool: hydrogen_link_store
- Handle OAuth flow through MCP
- Store tokens securely
- Configure .env automatically
- No terminal switching needed
```

#### Pain Point 2: Store Connection Verification
**Problem:** No easy way to verify store connection from Claude Code.

**IMPROVEMENT FOR HYDROGEN-FORGE MCP:**
```
Tool: hydrogen_verify_connection
- Check .env configuration
- Test Storefront API access
- Return store name + product count
- Quick health check
```

#### Pain Point 3: Mock.shop Default
**Problem:** New projects default to Mock.shop, developers may not realize they need to link.

**IMPROVEMENT FOR HYDROGEN-FORGE CLI:**
```
npx hydrogen-forge create my-store
- Prompt for store connection during creation
- No separate link step needed
- Or: clear warning about Mock.shop usage
```

---

### CURRENT MCP CONFIGURATION

#### Existing MCPs (from commerce-hub project)

**Shopify MCP (Modified)**
```json
{
  "name": "shopify",
  "tools": [
    "executeGraphQL",  // ADDED - run any GraphQL query
    "createProduct",
    "updateProduct",
    "getProduct",
    "getProducts"
  ]
}
```

**WooCommerce MCP (Modified)**
```json
{
  "name": "woocommerce", 
  "tools": [
    "wc_execute_rest",  // ADDED - run any REST endpoint
    "wc_get_products",
    "wc_get_product"
  ]
}
```

**GitHub MCP**
- Standard configuration
- Token: In CREDENTIALS-PRIVATE.md

**Supabase MCP**
- Standard configuration
- Keys: In CREDENTIALS-PRIVATE.md

---

### HYDROGEN-FORGE MCP ROADMAP

#### Planned Tools

**Store Management:**
```
hydrogen_link_store      - OAuth + .env configuration
hydrogen_verify_connection - Test store access
hydrogen_store_info      - Get store details
```

**Project Scaffolding:**
```
hydrogen_create_project  - Full project setup
hydrogen_add_component   - Scaffold new component
hydrogen_add_route       - Scaffold new route
```

**Development:**
```
hydrogen_dev_server      - Start/stop dev server
hydrogen_build           - Production build
hydrogen_deploy          - Deploy to Oxygen
```

**Quality:**
```
hydrogen_typecheck       - Run TypeScript check
hydrogen_lint            - Run ESLint
hydrogen_test            - Run Vitest
hydrogen_analyze         - Bundle analysis
```

---

### ENVIRONMENT FILES

#### .env Template (starter-skeleton)
```env
# Created by shopify hydrogen link
SESSION_SECRET="xxx"
PUBLIC_STOREFRONT_API_TOKEN="xxx"
PUBLIC_STORE_DOMAIN="your-store.myshopify.com"

# Optional
PRIVATE_STOREFRONT_API_TOKEN="xxx"
PUBLIC_CUSTOMER_ACCOUNT_API_CLIENT_ID="xxx"
PUBLIC_CUSTOMER_ACCOUNT_API_URL="xxx"
```

#### .shopify Folder
Created by `shopify hydrogen link` - contains store connection config.

---

---

### SESSION NOTES & LEARNINGS

#### Scope Creep Alert - Session 1
**What happened:** Started Day 1 research, but got sidetracked:
1. Set up skeleton (correct)
2. Connected to personal store (not the goal)
3. Started debugging Commerce Hub migrated products (32 products in DRAFT)
4. Claude Code tried to activate products via GraphQL
5. Lost focus on researching DEFAULT demo products

**Course correction applied:** 
- Told Claude Code to STOP and refocus
- Keep starter-skeleton connected to personal store (useful for later)
- Created SEPARATE demo-store-research to analyze Shopify defaults
- Using Mock.shop for research (not personal store)
- Document default demo structure BEFORE building improvements

**Commands used for course correction:**
```bash
# Created separate research folder with demo-store template
cd C:\xampp\htdocs\HYDROGEN-FORGE
npm create @shopify/hydrogen@latest -- --template demo-store --path demo-store-research --language ts --no-install-deps

# Then install deps
cd demo-store-research
npm install
```

**Lesson for Hydrogen Forge:** 
- CLI should ask: "Connect to store now or use Mock.shop for development?"
- Clear separation between research/dev mode and production mode
- Planner mode helps keep focus - use it when tasks are complex

#### Folder Structure After Session 1
```
C:\xampp\htdocs\HYDROGEN-FORGE\
├── starter-skeleton/           # Connected to personal store (32 products)
├── demo-store-research/        # Mock.shop data for research
├── Sessions/
│   └── Session-1/
│       ├── RESEARCH-NOTES.md
│       ├── CLAUDE-CODE-FIRST-SESSION.md
│       └── HYDROGEN-FORGE-SETUP-LOG.md
├── PRIVATE/
│   └── CREDENTIALS-MASTER.md
└── HYDROGEN-FORGE-MASTER-PLAN.md
```

---

### ISSUES ENCOUNTERED & FIXES

#### Issue 1: React Router Version Mismatch
**Symptom:** Dev server fails to start
**Cause:** Hydrogen skeleton has mismatched React Router dependencies
**Fix:**
```bash
cd C:\xampp\htdocs\HYDROGEN-FORGE\starter-skeleton
npm install react-router@7.9.2 react-router-dom@7.9.2
npm install -D @react-router/dev@7.9.2 @react-router/fs-routes@7.9.2
```

**Verify fix:**
```bash
npm ls react-router react-router-dom @react-router/dev @react-router/fs-routes
```

**NOTE FOR HYDROGEN-FORGE:** 
- Our starter should pin these versions correctly
- Add post-install script to verify dependency versions
- Document this as common issue in troubleshooting guide

---

#### Issue 2: Incorrect Link Flag
**Symptom:** `npx shopify hydrogen link --storefront` fails
**Error:** "Flag --storefront expects a value"
**Correct command:**
```bash
npx shopify hydrogen link
```
**Note:** The `--storefront` flag requires a storefront ID value if used. Without arguments, it prompts interactively.

**NOTE FOR HYDROGEN-FORGE:**
- Document correct link syntax
- Our MCP should handle this without flags

---

#### Issue 3: Hydrogen Link Permission Denied
**Symptom:** `npx shopify hydrogen link` fails with ACCESS_DENIED
**Error:** "Access denied for hydrogenStorefronts field. Required access: Request must be initiated from the Shopify CLI and user must have full access to apps or access to the Hydrogen channel."

**Root cause:** Permission/access issue with Shopify Partner account or Hydrogen channel not properly configured.

**Manual Workaround:**
1. Go to Shopify Admin → Headless (left sidebar)
2. Click existing storefront OR "Add storefront"
3. Click "Manage" next to Storefront API
4. Copy the Storefront API token
5. Manually update `.env` file

**Store Domain Found:** `dev-store-749237498237498787.myshopify.com`

**NOTE FOR HYDROGEN-FORGE MCP:**
- Should detect existing storefronts via API
- Let user select from list
- Auto-configure .env
- Bypass the broken `hydrogen link` flow entirely
- Could create custom Headless app/plugin to streamline this

---

#### Issue 4: Products Not Visible in Storefront
**Symptom:** Store connects, shows store name/collections/menus, but products area is empty
**Cause:** Products not published to Online Store / Headless sales channel
**What loads:** Shop info, Collections (Accessories), Menus (Home, Catalog, Contact), Footer
**What doesn't load:** Products

**Manual Fix:**
1. Shopify Admin → Products
2. Select all products
3. More actions → Manage sales channels
4. Enable "Online Store" 
5. Save

**MCP Automation Approach (BETTER):**
```graphql
# First, get products and publications
{
  products(first: 50) {
    nodes {
      id
      title
      publishedOnCurrentPublication
    }
  }
  publications(first: 10) {
    nodes {
      id
      name
    }
  }
}

# Then publish each product to Online Store
mutation publishablePublish($id: ID!, $input: [PublicationInput!]!) {
  publishablePublish(id: $id, input: $input) {
    publishable {
      availablePublicationsCount {
        count
      }
    }
    userErrors {
      field
      message
    }
  }
}
```

**NOTE FOR HYDROGEN-FORGE:**
- Should auto-check if products are published
- Offer to publish all products via MCP
- Part of store setup verification flow

---

### TERMINAL COMMANDS LOG

```bash
# Session 1 Commands
cd C:\xampp\htdocs\HYDROGEN-FORGE
npm create @shopify/hydrogen@latest -- --template skeleton starter-skeleton

cd C:\xampp\htdocs\HYDROGEN-FORGE\starter-skeleton
npx shopify hydrogen link

# Fix React Router mismatch
npm install react-router@7.9.2 react-router-dom@7.9.2
npm install -D @react-router/dev@7.9.2 @react-router/fs-routes@7.9.2
npm ls react-router react-router-dom @react-router/dev @react-router/fs-routes

npm run dev
```

---

### SCREENSHOTS TO CAPTURE

- [ ] Initial `npm create` prompts
- [ ] `shopify hydrogen link` OAuth flow
- [ ] Dev server running with real products
- [ ] Project folder structure
- [ ] .env file (redacted)

---

### NOTES FOR DOCUMENTATION

1. **Mock.shop Gotcha** - Developers will get confused when they see random products. Make this clear in docs.

2. **Partner Account Required** - Need Shopify Partner account, not just regular Shopify account.

3. **Dev Store Selection** - Link command shows all stores in Partner account, must select correct one.

4. **Token Storage** - Tokens stored in `.env` (local) and `.shopify/` folder. Don't commit these.

5. **Storefront API vs Admin API** - Hydrogen uses Storefront API (read-only public), different from Admin API used in Commerce Hub.

---

### CLAUDE CODE SESSION COMMANDS

(Add commands as they're run)

```
# Verification commands used
cd /c/xampp/htdocs/HYDROGEN-FORGE/starter-skeleton && ls -la .shopify
ls -la ~/.shopify
cd /c/xampp/htdocs/HYDROGEN-FORGE/starter-skeleton && timeout 15 npm run dev

# Add more as session progresses...
```

---

## UPDATES LOG

| Date | Update |
|------|--------|
| 2026-01-09 | Initial setup, skeleton project created |
| 2026-01-09 | Store linking process documented |
| 2026-01-09 | MCP pain points identified |

---

*This is a living document. Update after each session.*
